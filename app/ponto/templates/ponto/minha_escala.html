{% extends 'base.html' %}
{% block content %}
<div class="mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
    <div>
        <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
            <i class="fas fa-calendar-alt text-emerald-600"></i> Minha Escala
        </h2>
        <p class="text-sm text-slate-500 mt-1">Acompanhe os seus dias de trabalho e folga do mês.</p>
    </div>
    <div class="flex gap-2">
        <a href="{{ url_for('ponto.minha_escala', ano=ano if mes > 1 else ano-1, mes=mes-1 if mes > 1 else 12) }}" class="bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 font-bold py-2 px-4 rounded shadow-sm transition">
            <i class="fas fa-chevron-left"></i>
        </a>
        <div class="bg-white border border-slate-200 text-slate-800 font-bold py-2 px-8 rounded shadow-sm flex items-center justify-center min-w-[160px] text-lg uppercase tracking-wider">
            {{ '%02d' % mes }} / {{ ano }}
        </div>
        <a href="{{ url_for('ponto.minha_escala', ano=ano if mes < 12 else ano+1, mes=mes+1 if mes < 12 else 1) }}" class="bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 font-bold py-2 px-4 rounded shadow-sm transition">
            <i class="fas fa-chevron-right"></i>
        </a>
    </div>
</div>

<div class="bg-white rounded-xl border border-slate-200 shadow-sm p-6 lg:p-10">
    <div class="flex flex-wrap justify-center md:justify-start gap-6 mb-8 text-sm font-bold text-slate-600 border-b pb-4">
        <div class="flex items-center gap-2"><span class="w-4 h-4 rounded bg-blue-100 border border-blue-300 inline-block shadow-sm"></span> Plantão / Trabalho</div>
        <div class="flex items-center gap-2"><span class="w-4 h-4 rounded bg-slate-100 border border-slate-300 inline-block shadow-sm"></span> Folga</div>
        <div class="flex items-center gap-2"><span class="w-4 h-4 rounded bg-emerald-100 border border-emerald-300 inline-block shadow-sm"></span> Férias / Licença</div>
    </div>

    <div class="grid grid-cols-7 gap-2 text-center mb-3">
        <div class="text-xs font-black text-red-400 uppercase tracking-widest">Dom</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Seg</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Ter</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Qua</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Qui</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Sex</div>
        <div class="text-xs font-black text-slate-400 uppercase tracking-widest">Sáb</div>
    </div>

    <div class="grid grid-cols-7 gap-2 md:gap-4 auto-rows-fr">
        {% if dias_mes %}
            {% for _ in range(dias_mes[0].dia_semana) %}
                <div class="min-h-[80px] md:min-h-[100px] rounded bg-slate-50/50 border border-slate-100 border-dashed"></div>
            {% endfor %}
        {% endif %}

        {% for d in dias_mes %}
            {% set is_today = (d.data == hoje) %}
            
            {% if d.tipo == 'Trabalho' %}
                <div class="min-h-[80px] md:min-h-[100px] p-2 rounded-lg border border-blue-200 bg-blue-50 text-blue-900 flex flex-col items-center justify-center relative shadow-sm hover:shadow transition {{ 'ring-4 ring-blue-500 scale-105 z-10' if is_today else '' }}">
                    <span class="text-2xl md:text-3xl font-black">{{ d.data.day }}</span>
                    <span class="text-[10px] md:text-xs uppercase font-bold mt-2 text-blue-600 bg-blue-100 px-2 py-1 rounded w-full text-center">Trabalho</span>
                </div>
            {% elif d.tipo == 'Folga' %}
                <div class="min-h-[80px] md:min-h-[100px] p-2 rounded-lg border border-slate-200 bg-slate-50 text-slate-500 flex flex-col items-center justify-center relative shadow-sm hover:shadow transition {{ 'ring-4 ring-slate-400 scale-105 z-10' if is_today else '' }}">
                    <span class="text-2xl md:text-3xl font-black opacity-80">{{ d.data.day }}</span>
                    <span class="text-[10px] md:text-xs uppercase font-bold mt-2 text-slate-500 bg-slate-200 px-2 py-1 rounded w-full text-center">Folga</span>
                </div>
            {% else %}
                <div class="min-h-[80px] md:min-h-[100px] p-2 rounded-lg border border-emerald-200 bg-emerald-50 text-emerald-900 flex flex-col items-center justify-center relative shadow-sm hover:shadow transition {{ 'ring-4 ring-emerald-500 scale-105 z-10' if is_today else '' }}" title="{{ d.tipo }}">
                    <span class="text-2xl md:text-3xl font-black">{{ d.data.day }}</span>
                    <span class="text-[9px] md:text-xs uppercase font-bold mt-2 text-emerald-700 bg-emerald-200 px-1 py-1 rounded truncate w-full text-center">{{ d.tipo }}</span>
                </div>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}

